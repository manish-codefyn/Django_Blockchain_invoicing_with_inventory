# Instructions:
# 1. Create a project directory, e.g., "my_erp_project_root".
# 2. Inside "my_erp_project_root", save the following files according to the structure.
# 3. Create a Python virtual environment:
#    python -m venv venv
#    source venv/bin/activate  # On Windows: venv\Scripts\activate
# 4. Install Django:
#    pip install Django
# 5. Navigate into the "my_erp_project" directory (where manage.py is).
# 6. Run migrations:
#    python manage.py makemigrations hrm
#    python manage.py migrate
# 7. Create a superuser to access the admin panel:
#    python manage.py createsuperuser
# 8. Run the development server:
#    python manage.py runserver
# 9. Access the site at http://127.0.0.1:8000/
#    Access the admin panel at http://127.0.0.1:8000/admin/
#    Access the employee list at http://127.0.0.1:8000/hrm/employees/

# --- Project Structure ---
# my_erp_project_root/
# |--- my_erp_project/      # Django project directory
# |    |--- __init__.py
# |    |--- asgi.py
# |    |--- settings.py     # You will edit this
# |    |--- urls.py         # You will edit this
# |    |--- wsgi.py
# |--- hrm/                 # Django app directory (Human Resource Management)
# |    |--- __init__.py
# |    |--- admin.py        # You will create this
# |    |--- apps.py
# |    |--- migrations/
# |    |    |--- __init__.py
# |    |--- models.py       # You will create this
# |    |--- templates/
# |    |    |--- hrm/
# |    |    |    |--- base.html             # You will create this
# |    |    |    |--- employee_list.html    # You will create this
# |    |    |    |--- employee_detail.html  # You will create this
# |    |--- tests.py
# |    |--- urls.py         # You will create this
# |    |--- views.py        # You will create this
# |--- manage.py            # Django's command-line utility (created by startproject)
# |--- requirements.txt     # You will create this (optional, for dependencies)

# --- manage.py ---
# This file is automatically created when you start a Django project.
# To create a project named "my_erp_project" and an app named "hrm":
# django-admin startproject my_erp_project .  (Note the dot to create in current dir)
# cd my_erp_project
# python manage.py startapp hrm
# For this example, I'm assuming you'll place `manage.py` in "my_erp_project_root/".
# And the project configuration directory "my_erp_project/" will be inside "my_erp_project_root/my_erp_project/".
# To simplify, let's assume the standard structure:
# my_erp_project_root/
# |--- my_erp_project/
# |--- hrm/
# |--- manage.py

# For this immersive, imagine `manage.py` is in `my_erp_project_root/`
# and `my_erp_project` (settings, project urls) is also in `my_erp_project_root/`.
# This means the project directory and the app directory are siblings.

# If you use `django-admin startproject my_erp_project`, it creates:
# my_erp_project/
# |--- my_erp_project/  (inner project config dir)
# |--- manage.py
# Then you'd `cd my_erp_project` and `python manage.py startapp hrm`.
# The structure would be:
# my_erp_project/
# |--- my_erp_project/
# |--- hrm/
# |--- manage.py

# Let's assume the latter, more standard structure.
# So, all paths below are relative to the root `my_erp_project` directory
# that contains `manage.py`.

# --- my_erp_project/my_erp_project/settings.py ---
"""
Django settings for my_erp_project project.
Generated by 'django-admin startproject' using Django X.Y.Z.
"""
from pathlib import Path
import os # Add this import

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent

# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/stable/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-=your-secret-key-here!' # Replace with your actual secret key

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []

# Application definition
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'hrm',  # Add your hrm app here
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'my_erp_project.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [os.path.join(BASE_DIR, 'templates')], # Optional: project-level templates
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'my_erp_project.wsgi.application'

# Database
# https://docs.djangoproject.com/en/stable/ref/settings/#databases
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}

# Password validation
# https://docs.djangoproject.com/en/stable/ref/settings/#auth-password-validators
AUTH_PASSWORD_VALIDATORS = [
    # ... (default validators)
]

# Internationalization
# https://docs.djangoproject.com/en/stable/topics/i18n/
LANGUAGE_CODE = 'en-us'
TIME_ZONE = 'UTC'
USE_I18N = True
USE_TZ = True

# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/stable/howto/static-files/
STATIC_URL = 'static/'
# STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')] # Optional: project-level static files

# Default primary key field type
# https://docs.djangoproject.com/en/stable/ref/settings/#default-auto-field
DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'


# --- my_erp_project/my_erp_project/urls.py ---
from django.contrib import admin
from django.urls import path, include
from django.views.generic import RedirectView # Import RedirectView

urlpatterns = [
    path('admin/', admin.site.urls),
    path('hrm/', include('hrm.urls')),  # Include HRM app URLs
    path('', RedirectView.as_view(url='/hrm/employees/', permanent=True)), # Redirect root to employee list
]

# --- my_erp_project/hrm/models.py ---
from django.db import models
from django.utils import timezone

class Employee(models.Model):
    """
    Represents an employee in the HRM module.
    """
    employee_id = models.CharField(max_length=20, unique=True, help_text="Unique ID for the employee")
    first_name = models.CharField(max_length=100)
    last_name = models.CharField(max_length=100)
    email = models.EmailField(unique=True)
    phone_number = models.CharField(max_length=20, blank=True, null=True)
    date_of_joining = models.DateField(default=timezone.now)
    department = models.CharField(max_length=100, blank=True, null=True, help_text="e.g., Engineering, Sales, HR")
    role = models.CharField(max_length=100, blank=True, null=True, help_text="e.g., Software Engineer, Sales Manager")
    is_active = models.BooleanField(default=True, help_text="Is the employee currently active?")
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return f"{self.first_name} {self.last_name} ({self.employee_id})"

    class Meta:
        ordering = ['last_name', 'first_name'] # Default ordering

# --- my_erp_project/hrm/admin.py ---
from django.contrib import admin
from .models import Employee

@admin.register(Employee)
class EmployeeAdmin(admin.ModelAdmin):
    """
    Admin configuration for the Employee model.
    """
    list_display = ('employee_id', 'first_name', 'last_name', 'email', 'department', 'role', 'is_active', 'date_of_joining')
    list_filter = ('is_active', 'department', 'date_of_joining')
    search_fields = ('employee_id', 'first_name', 'last_name', 'email')
    ordering = ('last_name', 'first_name')
    fieldsets = (
        (None, {
            'fields': ('employee_id', 'first_name', 'last_name', 'email', 'phone_number')
        }),
        ('Employment Details', {
            'fields': ('department', 'role', 'date_of_joining', 'is_active')
        }),
    )
    # readonly_fields = ('created_at', 'updated_at') # If you want to show these in admin but not editable

# --- my_erp_project/hrm/apps.py ---
# This file is automatically created by `startapp`.
from django.apps import AppConfig

class HrmConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'hrm'


# --- my_erp_project/hrm/urls.py ---
from django.urls import path
from . import views

app_name = 'hrm' # Namespace for URLs

urlpatterns = [
    path('employees/', views.employee_list, name='employee_list'),
    path('employees/<int:pk>/', views.employee_detail, name='employee_detail'),
    # You can add create, update, delete views later
    # path('employees/new/', views.employee_create, name='employee_create'),
    # path('employees/<int:pk>/edit/', views.employee_update, name='employee_update'),
    # path('employees/<int:pk>/delete/', views.employee_delete, name='employee_delete'),
]

# --- my_erp_project/hrm/views.py ---
from django.shortcuts import render, get_object_or_404
from .models import Employee

def employee_list(request):
    """
    Displays a list of all active employees.
    """
    employees = Employee.objects.filter(is_active=True).order_by('last_name', 'first_name')
    context = {
        'employees': employees,
        'page_title': 'Employee List'
    }
    return render(request, 'hrm/employee_list.html', context)

def employee_detail(request, pk):
    """
    Displays details for a specific employee.
    """
    employee = get_object_or_404(Employee, pk=pk)
    context = {
        'employee': employee,
        'page_title': f"{employee.first_name} {employee.last_name}"
    }
    return render(request, 'hrm/employee_detail.html', context)

# Placeholder for future views (Create, Update, Delete)
# def employee_create(request):
#     # Logic for creating a new employee
#     pass

# def employee_update(request, pk):
#     # Logic for updating an existing employee
#     pass

# def employee_delete(request, pk):
#     # Logic for deleting an employee
#     pass


# --- my_erp_project/hrm/templates/hrm/base.html ---
"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}My ERP - HRM{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles can go here if needed */
        body {
            font-family: 'Inter', sans-serif; /* A common Tailwind font */
        }
        .sidebar {
            min-width: 250px; /* Ensure sidebar has a minimum width */
        }
        .content {
            flex-grow: 1; /* Allow content to take remaining space */
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-900">
    <div class="flex min-h-screen">
        <aside class="sidebar bg-slate-800 text-slate-100 p-6 space-y-6">
            <div class="text-2xl font-semibold text-white">ERP System</div>
            <nav>
                <ul class="space-y-2">
                    <li>
                        <a href="{% url 'hrm:employee_list' %}" class="block px-4 py-2.5 rounded-lg hover:bg-slate-700 transition duration-200">
                            Employees
                        </a>
                    </li>
                    <li>
                        <a href="/admin/" target="_blank" class="block px-4 py-2.5 rounded-lg hover:bg-slate-700 transition duration-200">
                            Admin Panel
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <main class="content p-8">
            <header class="mb-8">
                <h1 class="text-3xl font-bold text-gray-800">
                    {% block page_header %}{{ page_title|default:"HRM Module" }}{% endblock %}
                </h1>
            </header>
            
            {% block content %}
            {% endblock %}
        </main>
    </div>

    <footer class="bg-gray-800 text-white text-center p-4 mt-auto">
        <p>&copy; {% now "Y" %} My ERP Solutions. All rights reserved.</p>
    </footer>
</body>
</html>
"""

# --- my_erp_project/hrm/templates/hrm/employee_list.html ---
"""
{% extends "hrm/base.html" %}

{% block title %}Employee List - ERP HRM{% endblock %}

{% block page_header %}Employee Directory{% endblock %}

{% block content %}
<div class="bg-white shadow-md rounded-lg p-6">
    {% if messages %}
        <div class="mb-4">
            {% for message in messages %}
                <div class="p-3 rounded-md {% if message.tags == 'success' %}bg-green-100 text-green-700{% elif message.tags == 'error' %}bg-red-100 text-red-700{% else %}bg-blue-100 text-blue-700{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="mb-6 text-right">
        <a href="#" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
            Add New Employee
        </a>
    </div>

    {% if employees %}
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">ID</th>
                        <th class="px-6 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Name</th>
                        <th class="px-6 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Email</th>
                        <th class="px-6 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Department</th>
                        <th class="px-6 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Role</th>
                        <th class="px-6 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    {% for employee in employees %}
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ employee.employee_id }}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                <a href="{% url 'hrm:employee_detail' employee.pk %}" class="text-blue-600 hover:text-blue-800 hover:underline">
                                    {{ employee.first_name }} {{ employee.last_name }}
                                </a>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ employee.email }}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ employee.department|default:"N/A" }}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ employee.role|default:"N/A" }}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <a href="{% url 'hrm:employee_detail' employee.pk %}" class="text-indigo-600 hover:text-indigo-900 mr-3">View</a>
                                <a href="#" class="text-yellow-600 hover:text-yellow-900 mr-3">Edit</a>
                                <a href="#" class="text-red-600 hover:text-red-900">Delete</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="text-center py-10">
            <p class="text-gray-500 text-lg">No employees found.</p>
            <p class="mt-2 text-gray-400">Consider adding some employees via the <a href="/admin/hrm/employee/add/" target="_blank" class="text-blue-500 hover:underline">admin panel</a>.</p>
        </div>
    {% endif %}
</div>
{% endblock %}
"""

# --- my_erp_project/hrm/templates/hrm/employee_detail.html ---
"""
{% extends "hrm/base.html" %}

{% block title %}{{ employee.first_name }} {{ employee.last_name }} - ERP HRM{% endblock %}

{% block page_header %}Employee Profile: {{ employee.first_name }} {{ employee.last_name }}{% endblock %}

{% block content %}
<div class="bg-white shadow-lg rounded-lg p-8 max-w-4xl mx-auto">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="md:col-span-1 text-center">
            <div class="w-32 h-32 bg-gray-300 rounded-full mx-auto mb-4 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                </svg>
            </div>
            <h2 class="text-2xl font-semibold text-gray-800">{{ employee.first_name }} {{ employee.last_name }}</h2>
            <p class="text-gray-600">{{ employee.role|default:"No role specified" }}</p>
        </div>

        <div class="md:col-span-2 space-y-4">
            <div>
                <h3 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-2">Contact Information</h3>
                <p><strong class="text-gray-600">Employee ID:</strong> {{ employee.employee_id }}</p>
                <p><strong class="text-gray-600">Email:</strong> <a href="mailto:{{ employee.email }}" class="text-blue-600 hover:underline">{{ employee.email }}</a></p>
                <p><strong class="text-gray-600">Phone:</strong> {{ employee.phone_number|default:"N/A" }}</p>
            </div>
            
            <div>
                <h3 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-2">Employment Details</h3>
                <p><strong class="text-gray-600">Department:</strong> {{ employee.department|default:"N/A" }}</p>
                <p><strong class="text-gray-600">Date of Joining:</strong> {{ employee.date_of_joining|date:"F d, Y" }}</p>
                <p><strong class="text-gray-600">Status:</strong> 
                    {% if employee.is_active %}
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Active</span>
                    {% else %}
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Inactive</span>
                    {% endif %}
                </p>
            </div>

             <div>
                <h3 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-2">System Information</h3>
                <p><strong class="text-gray-600">Record Created:</strong> {{ employee.created_at|date:"F d, Y, P" }}</p>
                <p><strong class="text-gray-600">Last Updated:</strong> {{ employee.updated_at|date:"F d, Y, P" }}</p>
            </div>
        </div>
    </div>

    <div class="mt-8 pt-6 border-t text-right space-x-3">
        <a href="{% url 'hrm:employee_list' %}" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
            Back to List
        </a>
        <a href="#" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
            Edit Employee
        </a>
    </div>
</div>
{% endblock %}
"""

# --- my_erp_project/requirements.txt ---
"""
Django>=4.0,<5.0 # Or your preferred Django version
"""
